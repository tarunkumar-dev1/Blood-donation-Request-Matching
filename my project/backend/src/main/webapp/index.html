<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Blood Donation System - Save Lives</title>
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/professional-style.css" />
</head>
<body>
	<header class="site-header">
		<div class="container">
			<a class="logo" href="index.html">
				<img src="https://www.citypng.com/public/uploads/preview/blood-donate-illustration-design-sign-logo-png-704081694693639fiubls9faq.png" alt="Blood Donation logo" class="logo-img" />
			</a>
			<button id="nav-toggle" class="nav-toggle" aria-label="Toggle navigation">☰</button>
			<nav id="main-nav" class="main-nav">
				<ul>
					<li><a href="index.html">Home</a></li>
					<li><a href="about.html">About</a></li>
					<li><a href="contact.html">Contact</a></li>
				</ul>
			</nav>
			<!-- auth actions: opens modal. userBadge shows when logged in -->
			<div class="auth-actions">
				<a href="#" class="btn btn-outline js-login" id="openLogin">Register</a>
				<div id="userBadge" class="user-badge" style="display:none"></div>
			</div>
		</div>
	</header>

	<section id="home" class="hero">
		<div class="hero-inner container">
			<h1>Welcome to Blood Donation System</h1>
			<p class="hero-subtitle">Give Blood, Save Lives, Be a Hero</p>

			<!-- new: centered transparent large buttons (now links to separate pages) -->
			<div class="hero-actions">
				<a href="donor.html" class="hero-btn hero-btn-donor" aria-label="Become a donor">B Donor</a>
				<a href="bmatch.html" class="hero-btn hero-btn-match" aria-label="Find a match">B Match</a>
			</div>

			
		</div>
	</section>

	<!-- Blood groups: 8 linear cards with real-time data from database -->
	<section id="blood-groups" class="blood-groups container">
		<h2>Blood Availability</h2>
		<div class="group-cards">
			<div class="group-card card" data-blood-type="A+">
				<div class="group-name">A+</div>
				<div class="units">Units: <span class="unit-count">18</span></div>
			</div>
			<div class="group-card card" data-blood-type="A-">
				<div class="group-name">A-</div>
				<div class="units">Units: <span class="unit-count">9</span></div>
			</div>
			<div class="group-card card" data-blood-type="B+">
				<div class="group-name">B+</div>
				<div class="units">Units: <span class="unit-count">22</span></div>
			</div>
			<div class="group-card card" data-blood-type="B-">
				<div class="group-name">B-</div>
				<div class="units">Units: <span class="unit-count">11</span></div>
			</div>
			<div class="group-card card" data-blood-type="AB+">
				<div class="group-name">AB+</div>
				<div class="units">Units: <span class="unit-count">7</span></div>
			</div>
			<div class="group-card card" data-blood-type="AB-">
				<div class="group-name">AB-</div>
				<div class="units">Units: <span class="unit-count">4</span></div>
			</div>
			<div class="group-card card" data-blood-type="O+">
				<div class="group-name">O+</div>
				<div class="units">Units: <span class="unit-count">26</span></div>
			</div>
			<div class="group-card card" data-blood-type="O-">
				<div class="group-name">O-</div>
				<div class="units">Units: <span class="unit-count">13</span></div>
			</div>
		</div>
	</section>

	<!-- Statistics section: four cards with real-time database sync -->
	<section id="statistics" class="statistics container">
		<h2>Statistics</h2>
		<div class="stats-grid">
			<!-- Card 1: Total Donors - synced from database -->
			<div class="stat-card" data-stat="totalDonors">
				<div class="stat-label">Total Donors</div>
				<div class="stat-value stat-accent-red">64</div>
				<div class="stat-meta">Units available: 64</div>
			</div>

			<!-- Card 2: Lives Saved - calculated from donors -->
			<div class="stat-card" data-stat="livesSaved">
				<div class="stat-label">Lives Saved</div>
				<div class="stat-value stat-accent-green">137</div>
				<div class="stat-meta">Since launch</div>
			</div>

			<!-- Card 3: Active Requests - synced from database -->
			<div class="stat-card" data-stat="activeRequests">
				<div class="stat-label">Active Requests</div>
				<div class="stat-value stat-accent-orange">6</div>
				<div class="stat-meta">Open requests</div>
			</div>

			<!-- Card 4: Successful Matches - calculated -->
			<div class="stat-card" data-stat="successfulMatches">
				<div class="stat-label">Successful Matches</div>
				<div class="stat-value stat-accent-blue">52</div>
				<div class="stat-meta">Completed matches</div>
			</div>
		</div>
	</section>

	<!-- How it works: three step cards placed between Statistics and Contact -->
	<section id="how-it-works" class="how-it-works container">
		<h2>How It Works</h2>
		<div class="how-grid">
			<!-- Card 1: Register -->
			<div class="how-card">
				<div class="how-title">1. Register</div>
				<p>Create an account and complete your donor profile with blood type, location and availability information.</p>
			</div>

			<!-- Card 2: Match the Blood -->
			<div class="how-card">
				<div class="how-title">2. Get Matched</div>
				<p>Our system matches requests with verified donors based on blood type, location and urgency level.</p>
			</div>

			<!-- Card 3: Donate -->
			<div class="how-card">
				<div class="how-title">3. Donate & Save</div>
				<p>Coordinate with recipients or visit partner centers to deliver life-saving blood donations.</p>
			</div>
		</div>
	</section>

	<section id="contact" class="contact container">
		<h2>Contact</h2>
		<form class="contact-form" action="#" method="post" aria-label="Contact form" data-api="contact">
			<div class="form-grid">
				<input type="text" name="name" placeholder="Your name" required />
				<input type="email" name="email" placeholder="Your email" required />
			</div>
			<textarea name="message" placeholder="How can we help?" required></textarea>
			<div class="form-actions">
				<button type="submit" class="btn btn-primary">Send message</button>
				<small class="form-note">We will reply within 48 hours.</small>
			</div>
		</form>
	</section>

	<!-- unified footer: single wrapper containing all footer content -->
	<footer class="site-footer" aria-label="Site footer">
		<div class="footer-single">
			<div class="footer-block brand">
				<a href="index.html" class="footer-brand" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit;">
					<img src="https://www.citypng.com/public/uploads/preview/blood-donate-illustration-design-sign-logo-png-704081694693639fiubls9faq.png" alt="logo" style="height:44px;width:auto;border-radius:6px;" />
					<div>
						<strong>Blood Donation</strong>
						<div style="font-size:13px;color:var(--muted);">Connecting donors with those in need</div>
					</div>
				</a>
			</div>

			<div class="footer-block quick-links">
				<h4>Quick Links</h4>
				<nav aria-label="Quick links" style="display:flex;flex-direction:column;gap:6px;margin-top:6px;">
					<a class="footer-link" href="index.html">Home</a>
					<a class="footer-link" href="about.html">About</a>
					<a class="footer-link" href="contact.html">Contact</a>
				</nav>
			</div>

			<div class="footer-block resources">
				<h4>Resources</h4>
				<nav aria-label="Resources" style="display:flex;flex-direction:column;gap:6px;margin-top:6px;">
				<a class="footer-link" href="resources.html">Donor Guidelines</a>
				<a class="footer-link" href="resources.html">Blood Groups</a>
				<a class="footer-link" href="resources.html">Privacy Policy</a>
				<a class="footer-link" href="resources.html">Terms &amp; Conditions</a>
				</nav>
			</div>
			
			<div class="footer-block emergency">
				<h4>Emergency</h4>
				<address style="font-style:normal;margin-top:6px;line-height:1.5;">
					<div>Phone: <a href="tel:+1234567890" class="footer-link">+91 1234567890</a></div>
					<div>Email: <a href="mailto:help@blooddonation.example" class="footer-link">help@blooddonation.example</a></div>
					<div>123 Donor St, YourCity</div>
				</address>
			</div>

			<div class="footer-bottom">
				<div class="footer-note">Helping connect donors with those in need.</div>
				<div style="display:flex;gap:10px;align-items:center;">
					<a href="#home" class="btn" style="background:#ff4d4f;color:#fff;padding:8px 12px;border-radius:20px;text-decoration:none;">Back to top ↑</a>
				</div>
			</div>
		</div>
		
		<!-- Created with love footer -->
		<div style="background: linear-gradient(135deg, #1e1e2e 0%, #2a1a4a 100%); color: white; text-align: center; padding: 32px 20px; margin-top: 0; border-top: 4px solid #ffd700; box-shadow: 0 -4px 20px rgba(0,0,0,0.15);">
			<div style="font-family: 'Georgia', 'Times New Roman', serif; font-size: 1.15em; letter-spacing: 1px; display: inline-block; background: rgba(255,255,255,0.05); padding: 16px 32px; border-radius: 50px; backdrop-filter: blur(10px); border: 2px solid rgba(255,215,0,0.3);">
				<span style="color: #ffd700; font-size: 1.3em; text-shadow: 0 0 10px rgba(255,215,0,0.5); animation: pulse 2s ease-in-out infinite;">❤️</span>
				<span style="color: #e0e0e0; font-weight: 400; font-style: italic;">Crafted with passion by</span>
				<strong style="background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 800; font-size: 1.25em; margin: 0 6px; text-shadow: 0 2px 4px rgba(0,0,0,0.3); letter-spacing: 1.5px;">Tarun & Sarthak</strong>
				<span style="color: #ffd700; font-size: 1.3em; text-shadow: 0 0 10px rgba(255,215,0,0.5); animation: pulse 2s ease-in-out infinite;">❤️</span>
			</div>
			<style>
				@keyframes pulse {
					0%, 100% { transform: scale(1); opacity: 1; }
					50% { transform: scale(1.2); opacity: 0.8; }
				}
			</style>
		</div>
	</footer>

	<!-- Add: modal, styles and small script to handle login & restricted buttons -->
	<style>
/* modal + blur + user-badge styles (scoped to this page) */
.modal-overlay {
	position: fixed; inset: 0; display: none; align-items: center; justify-content: center;
	background: rgba(0,0,0,0.45); z-index: 1200;
}
.modal {
	width: 100%; max-width: 420px; background: #fff; padding: 18px; border-radius: 10px; box-shadow:0 18px 60px rgba(0,0,0,0.25);
}
.modal h3 { margin:0 0 12px; font-size:1.2rem; }
.modal .close { position:absolute; right:18px; top:14px; background:none;border:0;font-size:18px; cursor:pointer; }
body.modal-open header, body.modal-open main, body.modal-open footer { filter: blur(4px); pointer-events: none; user-select: none; }
body.modal-open .modal-overlay { display:flex; pointer-events:auto; }
.user-badge { margin-left:12px; padding:8px 12px; background:#ffeaea; color:#b71c1c; border-radius:20px; font-weight:600; cursor:pointer; display:inline-flex; align-items:center; gap:8px; }
.user-badge .logout { background:#b71c1c;color:#fff;border-radius:6px;padding:6px 8px;font-size:0.85rem; margin-left:8px; cursor:pointer; }

/* HERO buttons: bigger, more prominent, individual colours
   NOTE: sizes have been multiplied by 3 from previous values */
.hero-actions .hero-btn {
	text-decoration:none;
	display:inline-block;
	/* padding multiplied by 3: was 14px 22px -> now 42px 66px */
	padding: 42px 66px;
	border-radius: 16px;
	color:#fff;
	margin-right:10px;
	font-weight:700;
	/* font-size multiplied by 3: was 1.05rem -> now 3.15rem */
	font-size:3.15rem;
	box-shadow: 0 12px 28px rgba(0,0,0,0.14);
	transition: transform .12s ease, box-shadow .12s ease, opacity .12s;
}
.hero-actions .hero-btn:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.20); opacity:0.98; }

/* Distinct styles for donor / match buttons */
.hero-btn-donor { background: linear-gradient(135deg,#ff4d4f,#ff7a79); }
.hero-btn-match { background: linear-gradient(135deg,#007acc,#00d4ff); }

/* CONTACT FORM: centered card, pleasant inputs, two-column grid on wide screens */
.contact .contact-form {
	max-width: 600px;
	margin: 18px auto;
	background: #fff;
	padding: 12px;
	border-radius: 12px;
	box-shadow: 0 20px 40px rgba(0,0,0,0.06);
	border: 1px solid #f0f0f0;
}
.contact .contact-form .form-grid {
	display: grid;
	grid-template-columns: 1fr 1fr;
	gap: 12px;
}
.contact .contact-form input,
.contact .contact-form textarea {
	width: 100%;
	padding: 12px 14px;
	border-radius: 10px;
	border: 1px solid #e6e6e6;
	font-size: 0.95rem;
	background: #fafafa;
	box-sizing: border-box;
}
.contact .contact-form input:focus,
.contact .contact-form textarea:focus {
	outline: none;
	border-color: rgba(255,77,79,0.9);
	box-shadow: 0 6px 18px rgba(255,77,79,0.06);
}
.contact .contact-form textarea {
	min-height: 140px;
	resize: vertical;
	margin-top: 10px;
}
.contact .contact-form .form-actions {
	display:flex;
	align-items:center;
	justify-content:space-between;
	gap:12px;
	margin-top:12px;
	flex-wrap:wrap;
}
.contact .btn.btn-primary {
	background: linear-gradient(90deg,#ff4d4f,#ff7a79);
	color:#fff;
	padding:10px 16px;
	border-radius:10px;
	border:none;
	box-shadow: 0 8px 18px rgba(255,77,79,0.18);
	cursor: pointer;
}
.contact .btn.btn-primary:hover { transform: translateY(-2px); }

.contact .form-note {
	color: var(--muted, #666);
	font-size: 0.9rem;
}

.admin-login-btn { cursor:pointer; }
/* admin modal (reuse base modal look) */
.admin-modal-overlay {
	position: fixed; inset:0; display:none; align-items:center; justify-content:center;
	background: rgba(0,0,0,0.45); z-index:1200;
}
.admin-modal {
	width:100%; max-width:420px; background:#fff; padding:18px; border-radius:10px; box-shadow:0 18px 60px rgba(0,0,0,0.25); position:relative;
}
.admin-modal h3 { margin:0 0 12px; font-size:1.2rem; }
.admin-modal .close { position:absolute; right:18px; top:14px; background:none;border:0;font-size:18px; cursor:pointer; }

/* small screens: stack inputs, adjust buttons
   mobile button sizes also scaled x3 relative to previous mobile size
   (previous mobile font-size was 0.95rem -> now ~2.85rem) */
@media (max-width: 640px) {
	.hero-actions .hero-btn { font-size: 2.85rem; padding: 36px 48px; }
	.contact .contact-form { padding: 16px; margin: 12px; }
	.contact .contact-form .form-grid { grid-template-columns: 1fr; }
	.contact .contact-form .form-actions { justify-content: flex-start; gap:10px; }
}
</style>

<!-- modal markup -->
<div class="modal-overlay" id="loginModal" aria-hidden="true">
	<div class="modal" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
		<button class="close" id="closeModal" aria-label="Close">✕</button>
		<h3 id="loginTitle">Register to Blood Donation</h3>
		<form id="modalLoginForm">
			<label for="modalPhone">Phone</label>
			<input id="modalPhone" name="phone" type="tel" inputmode="tel" placeholder="+1 234 567 890" required style="width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #e6e6e6"/>
			<label for="modalPass">Password</label>
			<input id="modalPass" name="password" type="password" placeholder="Password" required style="width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #e6e6e6"/>
			<div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px;">
				<button type="submit" class="btn" style="background:#ff4d4f;color:#fff;padding:10px 14px;border-radius:8px;border:none;">Register</button>
				<button type="button" id="modalCancel" class="btn btn-outline" style="background:transparent;border:1px solid #ddd;padding:8px 12px;border-radius:8px;">Cancel</button>
			</div>
		</form>
	</div>
</div>

<div class="admin-modal-overlay" id="adminLoginModal" aria-hidden="true">
	<div class="admin-modal" role="dialog" aria-modal="true" aria-labelledby="adminLoginTitle">
		<button class="close" id="closeAdminModal" aria-label="Close">✕</button>
		<h3 id="adminLoginTitle">Admin Login</h3>
		<form id="adminLoginForm">
			<label for="adminUser">Username</label>
			<input id="adminUser" name="username" type="text" placeholder="Admin username" required style="width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #e6e6e6"/>
			<label for="adminPass">Password</label>
			<input id="adminPass" name="password" type="password" placeholder="Password" required style="width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #e6e6e6"/>
			<div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px;">
				<button type="submit" class="btn" style="background:#333;color:#fff;padding:10px 14px;border-radius:8px;border:none;">Login</button>
				<button type="button" id="cancelAdminModal" class="btn btn-outline" style="background:transparent;border:1px solid #ddd;padding:8px 12px;border-radius:8px;">Cancel</button>
			</div>
		</form>
	</div>
</div>


<script src="bridge.jsp"></script>
<script src="js/api-client.js"></script>

<script>
/* minimal login modal + localStorage user handling backed by servlet */
(function(){
	const modal = document.getElementById('loginModal');
	const openButtons = document.querySelectorAll('.js-login');
	const closeBtn = document.getElementById('closeModal');
	const cancelBtn = document.getElementById('modalCancel');
	const form = document.getElementById('modalLoginForm');
	const userBadge = document.getElementById('userBadge');

	function isLoggedIn(){ return !!localStorage.getItem('bd_user'); }
	function updateBadge(){
		const user = JSON.parse(localStorage.getItem('bd_user') || 'null');
		if(user && user.phone){
			userBadge.innerHTML = '<span class="uid">'+user.phone+'</span><button class="logout" id="logoutBtn">Logout</button>';
			userBadge.style.display = 'inline-flex';
			document.querySelectorAll('.js-login').forEach(el => el.style.display='none');
			const lb = document.getElementById('logoutBtn');
			lb && lb.addEventListener('click', ()=>{ localStorage.removeItem('bd_user'); location.href='index.html'; });
		} else {
			userBadge.style.display = 'none';
			document.querySelectorAll('.js-login').forEach(el => el.style.display='inline-block');
		}
	}

	function openModal(){ document.body.classList.add('modal-open'); modal.setAttribute('aria-hidden','false'); }
	function closeModal(){ document.body.classList.remove('modal-open'); modal.setAttribute('aria-hidden','true'); }

	openButtons.forEach(b => b.addEventListener('click', function(e){ e.preventDefault(); openModal(); }));

	closeBtn.addEventListener('click', closeModal);
	cancelBtn.addEventListener('click', closeModal);
	modal.addEventListener('click', function(e){ if(e.target===modal) closeModal(); });

	form.addEventListener('submit', async function(e){
		e.preventDefault();
		const phone = document.getElementById('modalPhone').value.trim();
		const password = document.getElementById('modalPass').value.trim();
		if(!phone){ alert('Enter valid phone number'); return; }
		try{ await window.apiClient.auth.register(phone, password); }
		catch(err){ alert(err.message || 'Registration failed'); return; }
		localStorage.setItem('bd_user', JSON.stringify({ phone: phone }));
		updateBadge();
		closeModal();
		location.href = 'index.html';
	});

	/* restrict B-Donor / B-Match buttons if not logged in */
	document.addEventListener('click', function(e){
		const target = e.target.closest && e.target.closest('.hero-btn');
		if(!target) return;
		const href = target.getAttribute('href') || '';
		const requiresAuth = /donor\.html|bmatch\.html/.test(href);
		if(requiresAuth && !isLoggedIn()){
			e.preventDefault();
			openModal();
		}
	});

	// update badge on load
	updateBadge();
})();
</script>

</body>
</html>
